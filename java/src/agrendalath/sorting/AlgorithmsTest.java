package agrendalath.sorting;

import org.junit.Test;

import java.util.Arrays;
import java.util.Random;

import static org.junit.Assert.assertArrayEquals;

public class AlgorithmsTest {
    private static final Short[] EMPTY_ARRAY = {};
    private static final Byte[] ONE_ELEMENT_ARRAY = {4};
    private static final Integer[] ARRAY0 = {6, -1, -100, 10000};
    private static final Integer[] ARRAY0_RESULT = {-100, -1, 6, 10000};
    private static final Integer[] ARRAY1 = {3, 1, 6, 10, 2, 7, 6, 11, -1};
    private static final Integer[] ARRAY1_RESULT = {-1, 1, 2, 3, 6, 6, 7, 10, 11};
    private static final Integer[] ARRAY2 = {676, 8387, 2886, 7324, 7274, 491, 2923, 6116, 9841, 9202, 1785, 1610, 2176, 6490, 4162, 2727, 1928, 3126, 360, 2793, 9429, 8399, 1406, 8821, 5463, 8078, 175, 4411, 9741, 1514, 1726, 4568, 2118, 6624, 1331, 9572, 3355, 4794, 5922, 3467, 4315, 6581, 137, 3705, 1710, 8110, 1938, 7668, 6257, 1819, 3293, 1815, 5940, 7355, 3879, 8424, 305, 1690, 5731, 9998, 8125, 3142, 5999, 1861, 1336, 3884, 2462, 9516, 3378, 6109, 7360, 9162, 5550, 76, 5298, 7419, 9413, 7168, 611, 6888, 6998, 5091, 6276, 3002, 6710, 5823, 9075, 9441, 9957, 5224, 2717, 8247, 2929, 5078, 310, 3702, 3319, 6053, 8407, 7323, 8547, 5698, 707, 2418, 208, 8645, 7217, 7241, 5146, 5772, 3257, 6845, 2503, 8916, 9087, 5732, 4686, 3105, 5244, 2222, 4698, 1739, 2345, 545, 6274, 9330, 6380, 9409, 3944, 6075, 9155, 1070, 3708, 6489, 9680, 38, 7267, 2247, 5662, 3008, 8569, 8509, 3188, 1892, 953, 3651, 6407, 9306, 6126, 33, 2643, 2142, 7801, 7625, 5301, 8941, 8769, 7835, 5576, 8016, 8336, 8344, 1888, 8103, 7801, 5831, 1368, 5187, 958, 5342, 1191, 5575, 9090, 7466, 3665, 6620, 978, 7297, 1406, 963, 9806, 3811, 1958, 4214, 6975, 3232, 1983, 3599, 2010, 630, 3370, 279, 8087, 9773, 1438, 7664, 4014, 4094, 8135, 5010, 9063, 6813, 8963, 5431, 8301, 7249, 8166, 6170, 1992, 6886, 9112, 7927, 8664, 1469, 9197, 4795, 6550, 5029, 337, 6951, 6008, 8904, 42, 8898, 8214, 6028, 4013, 1148, 6757, 4961, 8148, 4065, 1628, 3770, 6982, 8467, 5315, 3980, 8665, 760, 7476, 8217, 8357, 8030, 2072, 6977, 4701, 7139, 9933, 3307, 8447, 4013, 9158, 8114, 8836, 990, 795, 5641, 5415, 1246, 8453, 6657, 5968, 2550, 4351, 431, 5071, 8345, 6272, 7919, 6359, 4573, 8854, 508, 5776, 8389, 5462, 4258, 6601, 6203, 7827, 2702, 822, 4075, 633, 8833, 8889, 3884, 2541, 6538, 5835, 7757, 3025, 9589, 730, 6894, 3082, 4293, 7193, 6703, 1544, 436, 6787, 6287, 32, 4343, 6309, 3399, 9353, 6776, 4692, 1984, 361, 9342, 932, 5704, 1584, 1090, 8598, 3787, 8354, 7979, 6759, 4001, 955, 1719, 9814, 5710, 8292, 2268, 5225, 2590, 405, 1201, 3440, 4365, 5381, 7693, 9059, 5181, 5464, 6909, 4893, 737, 5586, 6311, 6131, 2891, 3577, 6174, 2355, 1779, 8152, 4341, 2838, 7009, 2529, 6679, 1997, 6392, 4566, 3485, 5266, 8390, 1727, 3971, 1947, 650, 1024, 2015, 5999, 9163, 9229, 9477, 7963, 1425, 3182, 9054, 8863, 3342, 8285, 9515, 6468, 8293, 1090, 6758, 407, 8861, 216, 1030, 251, 7362, 621, 9846, 5758, 7498, 2122, 7739, 8737, 1121, 7650, 4896, 4612, 8003, 6002, 3290, 7265, 5390, 3260, 7647, 2571, 9229, 378, 9025, 7287, 5596, 7457, 8247, 8273, 9098, 6997, 3775, 8672, 6095, 7004, 4385, 555, 5472, 413, 5793, 471, 8430, 7425, 8223, 4343, 7287, 5279, 5090, 4919, 3329, 9513, 3315, 2891, 8483, 4931, 5521, 8063, 1670, 3948, 4395, 1306, 9595, 2557, 1963, 6931, 5083, 7703, 7906, 7780, 5170, 5361, 6850, 3021, 3126, 912, 6764, 5013, 9204, 3412, 9415, 6215, 5284, 7535, 1566, 3956, 9843, 9308, 2130, 6528, 9219, 9802, 7953, 3305, 9655, 5801, 1900, 9699, 5326, 9626, 1446, 8981, 2497, 3932, 984, 1684, 4736, 5498, 2331, 1254, 1900, 5985, 7634, 2445, 1531, 1803, 9726, 2439, 7457, 3405, 8792, 1051, 4829, 55, 2229, 2661, 977, 9810, 3660, 9987, 6483, 9514, 8257, 2204, 8068, 2653, 9757, 5540, 3253, 3289, 6131, 2222, 9349, 5111, 8972, 596, 9587, 1766, 9743, 2930, 8821, 775, 4327, 3405, 8394, 3441, 8129, 8650, 3762, 4204, 6462, 3753, 7756, 1868, 703, 1975, 2254, 8856, 5790, 5638, 7926, 105, 9280, 4869, 3958, 2876, 2900, 7587, 8361, 9335, 4376, 8170, 697, 740, 8985, 6309, 5609, 9005, 3393, 3370, 7126, 7019, 3509, 8882, 9812, 4413, 4155, 2967, 3062, 1350, 934, 6098, 791, 1125, 7570, 1829, 9295, 9224, 3345, 9111, 6953, 3987, 5618, 2792, 8489, 5803, 2282, 3154, 7086, 5255, 7210, 1892, 6763, 4806, 174, 2162, 4575, 3182, 8469, 3079, 5642, 3810, 9858, 3612, 4497, 383, 6967, 5415, 5508, 3710, 6072, 4737, 2235, 1273, 8680, 7540, 5171, 5504, 1721, 123, 4302, 3572, 1880, 9600, 6399, 5880, 2253, 1531, 4519, 9908, 8304, 8712, 7534, 4219, 3130, 5251, 3026, 5733, 5102, 4153, 2692, 4141, 987, 5816, 1828, 3258, 1366, 5907, 4010, 5214, 6993, 7661, 9652, 5051, 9612, 6478, 6462, 5710, 1777, 4206, 7867, 4919, 1489, 7713, 3286, 1301, 4569, 9125, 879, 1375, 8779, 4773, 2287, 3527, 4028, 9329, 3208, 5766, 8380, 7713, 6507, 9171, 1131, 3608, 8607, 9006, 1458, 4362, 217, 2508, 2479, 9993, 478, 6129, 4921, 4828, 3864, 6488, 3625, 9415, 4106, 2644, 4747, 5163, 4309, 1278, 5162, 8817, 9849, 2197, 8950, 957, 3979, 6109, 1873, 9655, 7503, 5115, 9212, 716, 2962, 335, 3161, 3377, 2041, 3490, 67, 4225, 715, 1235, 4155, 9565, 3842, 6350, 1523, 4105, 176, 3215, 1673, 6212, 7415, 8342, 7832, 8308, 608, 1135, 2047, 706, 892, 3624, 1903, 902, 94, 3376, 8640, 8082, 7934, 5400, 7464, 4622, 6965, 4780, 2831, 1696, 2814, 8689, 3608, 3828, 2067, 2770, 3578, 8093, 1742, 439, 9557, 5972, 2026, 9808, 7546, 3676, 6223, 1566, 1576, 6650, 7143, 1951, 2688, 6471, 8290, 9572, 6346, 3576, 8427, 7839, 5315, 9295, 1484, 5639, 4773, 9256, 4381, 3719, 8538, 9646, 1568, 4845, 8749, 1412, 8545, 4187, 7399, 2254, 1746, 5444, 9210, 498, 1171, 4680, 438, 66, 7043, 3658, 604, 5181, 8266, 4924, 8536, 9648, 9698, 3999, 2290, 664, 227, 8875, 6582, 9832, 5835, 8418, 3546, 9910, 2947, 276, 5501, 3224, 6447, 3214, 8551, 2809, 7055, 6418, 800, 242, 6119, 4780, 4838, 9353, 7302, 778, 4287, 8646, 5525, 6518, 3475, 1292, 1377, 1837, 8018, 2850, 4012, 4198, 6831, 8046, 4904, 2806, 3710, 9448, 5286, 8963, 2300, 7548, 7229, 7074, 1571, 9366, 2850, 5077, 9737, 8915, 9605, 2645, 9629, 6225, 2047, 6960, 8019, 8351, 7464, 8483, 7830, 8404, 7808, 2662, 7908, 9265, 7418, 1769, 3546, 8193, 8634, 5530, 6141, 3174, 8251, 4543, 7615, 679, 5982, 4418, 9452, 2445, 883, 9750, 3039, 9252, 7751, 9519, 4057, 9677, 9432, 4481, 6362, 2983, 59, 7871, 5982, 2404, 6438, 2613, 1568, 2867, 1346, 5832, 9840, 8900, 9305, 1381, 7510, 8377, 3321, 4827, 2366, 4986, 9774, 7637, 2111, 4642, 8353, 243, 6853, 5395, 1794, 1705, 6460, 2006, 6325, 3635, 4073, 270, 8971, 2412, 9927, 8792, 5369, 8216, 1040, 2505, 1524, 9911, 1737, 2599, 2935};
    private static final Integer[] ARRAY2_RESULT = {32, 33, 38, 42, 55, 59, 66, 67, 76, 94, 105, 123, 137, 174, 175, 176, 208, 216, 217, 227, 242, 243, 251, 270, 276, 279, 305, 310, 335, 337, 360, 361, 378, 383, 405, 407, 413, 431, 436, 438, 439, 471, 478, 491, 498, 508, 545, 555, 596, 604, 608, 611, 621, 630, 633, 650, 664, 676, 679, 697, 703, 706, 707, 715, 716, 730, 737, 740, 760, 775, 778, 791, 795, 800, 822, 879, 883, 892, 902, 912, 932, 934, 953, 955, 957, 958, 963, 977, 978, 984, 987, 990, 1024, 1030, 1040, 1051, 1070, 1090, 1090, 1121, 1125, 1131, 1135, 1148, 1171, 1191, 1201, 1235, 1246, 1254, 1273, 1278, 1292, 1301, 1306, 1331, 1336, 1346, 1350, 1366, 1368, 1375, 1377, 1381, 1406, 1406, 1412, 1425, 1438, 1446, 1458, 1469, 1484, 1489, 1514, 1523, 1524, 1531, 1531, 1544, 1566, 1566, 1568, 1568, 1571, 1576, 1584, 1610, 1628, 1670, 1673, 1684, 1690, 1696, 1705, 1710, 1719, 1721, 1726, 1727, 1737, 1739, 1742, 1746, 1766, 1769, 1777, 1779, 1785, 1794, 1803, 1815, 1819, 1828, 1829, 1837, 1861, 1868, 1873, 1880, 1888, 1892, 1892, 1900, 1900, 1903, 1928, 1938, 1947, 1951, 1958, 1963, 1975, 1983, 1984, 1992, 1997, 2006, 2010, 2015, 2026, 2041, 2047, 2047, 2067, 2072, 2111, 2118, 2122, 2130, 2142, 2162, 2176, 2197, 2204, 2222, 2222, 2229, 2235, 2247, 2253, 2254, 2254, 2268, 2282, 2287, 2290, 2300, 2331, 2345, 2355, 2366, 2404, 2412, 2418, 2439, 2445, 2445, 2462, 2479, 2497, 2503, 2505, 2508, 2529, 2541, 2550, 2557, 2571, 2590, 2599, 2613, 2643, 2644, 2645, 2653, 2661, 2662, 2688, 2692, 2702, 2717, 2727, 2770, 2792, 2793, 2806, 2809, 2814, 2831, 2838, 2850, 2850, 2867, 2876, 2886, 2891, 2891, 2900, 2923, 2929, 2930, 2935, 2947, 2962, 2967, 2983, 3002, 3008, 3021, 3025, 3026, 3039, 3062, 3079, 3082, 3105, 3126, 3126, 3130, 3142, 3154, 3161, 3174, 3182, 3182, 3188, 3208, 3214, 3215, 3224, 3232, 3253, 3257, 3258, 3260, 3286, 3289, 3290, 3293, 3305, 3307, 3315, 3319, 3321, 3329, 3342, 3345, 3355, 3370, 3370, 3376, 3377, 3378, 3393, 3399, 3405, 3405, 3412, 3440, 3441, 3467, 3475, 3485, 3490, 3509, 3527, 3546, 3546, 3572, 3576, 3577, 3578, 3599, 3608, 3608, 3612, 3624, 3625, 3635, 3651, 3658, 3660, 3665, 3676, 3702, 3705, 3708, 3710, 3710, 3719, 3753, 3762, 3770, 3775, 3787, 3810, 3811, 3828, 3842, 3864, 3879, 3884, 3884, 3932, 3944, 3948, 3956, 3958, 3971, 3979, 3980, 3987, 3999, 4001, 4010, 4012, 4013, 4013, 4014, 4028, 4057, 4065, 4073, 4075, 4094, 4105, 4106, 4141, 4153, 4155, 4155, 4162, 4187, 4198, 4204, 4206, 4214, 4219, 4225, 4258, 4287, 4293, 4302, 4309, 4315, 4327, 4341, 4343, 4343, 4351, 4362, 4365, 4376, 4381, 4385, 4395, 4411, 4413, 4418, 4481, 4497, 4519, 4543, 4566, 4568, 4569, 4573, 4575, 4612, 4622, 4642, 4680, 4686, 4692, 4698, 4701, 4736, 4737, 4747, 4773, 4773, 4780, 4780, 4794, 4795, 4806, 4827, 4828, 4829, 4838, 4845, 4869, 4893, 4896, 4904, 4919, 4919, 4921, 4924, 4931, 4961, 4986, 5010, 5013, 5029, 5051, 5071, 5077, 5078, 5083, 5090, 5091, 5102, 5111, 5115, 5146, 5162, 5163, 5170, 5171, 5181, 5181, 5187, 5214, 5224, 5225, 5244, 5251, 5255, 5266, 5279, 5284, 5286, 5298, 5301, 5315, 5315, 5326, 5342, 5361, 5369, 5381, 5390, 5395, 5400, 5415, 5415, 5431, 5444, 5462, 5463, 5464, 5472, 5498, 5501, 5504, 5508, 5521, 5525, 5530, 5540, 5550, 5575, 5576, 5586, 5596, 5609, 5618, 5638, 5639, 5641, 5642, 5662, 5698, 5704, 5710, 5710, 5731, 5732, 5733, 5758, 5766, 5772, 5776, 5790, 5793, 5801, 5803, 5816, 5823, 5831, 5832, 5835, 5835, 5880, 5907, 5922, 5940, 5968, 5972, 5982, 5982, 5985, 5999, 5999, 6002, 6008, 6028, 6053, 6072, 6075, 6095, 6098, 6109, 6109, 6116, 6119, 6126, 6129, 6131, 6131, 6141, 6170, 6174, 6203, 6212, 6215, 6223, 6225, 6257, 6272, 6274, 6276, 6287, 6309, 6309, 6311, 6325, 6346, 6350, 6359, 6362, 6380, 6392, 6399, 6407, 6418, 6438, 6447, 6460, 6462, 6462, 6468, 6471, 6478, 6483, 6488, 6489, 6490, 6507, 6518, 6528, 6538, 6550, 6581, 6582, 6601, 6620, 6624, 6650, 6657, 6679, 6703, 6710, 6757, 6758, 6759, 6763, 6764, 6776, 6787, 6813, 6831, 6845, 6850, 6853, 6886, 6888, 6894, 6909, 6931, 6951, 6953, 6960, 6965, 6967, 6975, 6977, 6982, 6993, 6997, 6998, 7004, 7009, 7019, 7043, 7055, 7074, 7086, 7126, 7139, 7143, 7168, 7193, 7210, 7217, 7229, 7241, 7249, 7265, 7267, 7274, 7287, 7287, 7297, 7302, 7323, 7324, 7355, 7360, 7362, 7399, 7415, 7418, 7419, 7425, 7457, 7457, 7464, 7464, 7466, 7476, 7498, 7503, 7510, 7534, 7535, 7540, 7546, 7548, 7570, 7587, 7615, 7625, 7634, 7637, 7647, 7650, 7661, 7664, 7668, 7693, 7703, 7713, 7713, 7739, 7751, 7756, 7757, 7780, 7801, 7801, 7808, 7827, 7830, 7832, 7835, 7839, 7867, 7871, 7906, 7908, 7919, 7926, 7927, 7934, 7953, 7963, 7979, 8003, 8016, 8018, 8019, 8030, 8046, 8063, 8068, 8078, 8082, 8087, 8093, 8103, 8110, 8114, 8125, 8129, 8135, 8148, 8152, 8166, 8170, 8193, 8214, 8216, 8217, 8223, 8247, 8247, 8251, 8257, 8266, 8273, 8285, 8290, 8292, 8293, 8301, 8304, 8308, 8336, 8342, 8344, 8345, 8351, 8353, 8354, 8357, 8361, 8377, 8380, 8387, 8389, 8390, 8394, 8399, 8404, 8407, 8418, 8424, 8427, 8430, 8447, 8453, 8467, 8469, 8483, 8483, 8489, 8509, 8536, 8538, 8545, 8547, 8551, 8569, 8598, 8607, 8634, 8640, 8645, 8646, 8650, 8664, 8665, 8672, 8680, 8689, 8712, 8737, 8749, 8769, 8779, 8792, 8792, 8817, 8821, 8821, 8833, 8836, 8854, 8856, 8861, 8863, 8875, 8882, 8889, 8898, 8900, 8904, 8915, 8916, 8941, 8950, 8963, 8963, 8971, 8972, 8981, 8985, 9005, 9006, 9025, 9054, 9059, 9063, 9075, 9087, 9090, 9098, 9111, 9112, 9125, 9155, 9158, 9162, 9163, 9171, 9197, 9202, 9204, 9210, 9212, 9219, 9224, 9229, 9229, 9252, 9256, 9265, 9280, 9295, 9295, 9305, 9306, 9308, 9329, 9330, 9335, 9342, 9349, 9353, 9353, 9366, 9409, 9413, 9415, 9415, 9429, 9432, 9441, 9448, 9452, 9477, 9513, 9514, 9515, 9516, 9519, 9557, 9565, 9572, 9572, 9587, 9589, 9595, 9600, 9605, 9612, 9626, 9629, 9646, 9648, 9652, 9655, 9655, 9677, 9680, 9698, 9699, 9726, 9737, 9741, 9743, 9750, 9757, 9773, 9774, 9802, 9806, 9808, 9810, 9812, 9814, 9832, 9840, 9841, 9843, 9846, 9849, 9858, 9908, 9910, 9911, 9927, 9933, 9957, 9987, 9993, 9998};
    private static final Long[] ARRAY3;
    private static final Long[] ARRAY3_RESULT;

    static {
        Random random = new Random();
        ARRAY3 = new Long[100000];
        for (int i = 0; i < ARRAY3.length; ++i) {
            ARRAY3[i] = random.nextLong();
        }
        ARRAY3_RESULT = ARRAY3.clone();
        Arrays.sort(ARRAY3_RESULT);
    }

    @Test
    public void shuffleSort() {
        assertArrayEquals(EMPTY_ARRAY, Algorithms.shuffleSort(EMPTY_ARRAY.clone()));
        assertArrayEquals(ONE_ELEMENT_ARRAY, Algorithms.shuffleSort(ONE_ELEMENT_ARRAY.clone()));
        assertArrayEquals(ARRAY0_RESULT, Algorithms.shuffleSort(ARRAY0.clone()));
        assertArrayEquals(ARRAY1_RESULT, Algorithms.shuffleSort(ARRAY1.clone()));
    }

    @Test
    public void stupidSort() {
        assertArrayEquals(EMPTY_ARRAY, Algorithms.stupidSort(EMPTY_ARRAY.clone()));
        assertArrayEquals(ONE_ELEMENT_ARRAY, Algorithms.stupidSort(ONE_ELEMENT_ARRAY.clone()));
        assertArrayEquals(ARRAY0_RESULT, Algorithms.stupidSort(ARRAY0.clone()));
        assertArrayEquals(ARRAY1_RESULT, Algorithms.stupidSort(ARRAY1.clone()));
        assertArrayEquals(ARRAY2_RESULT, Algorithms.stupidSort(ARRAY2.clone()));
//        assertArrayEquals(ARRAY3_RESULT, Algorithms.stupidSort(ARRAY3));
    }

    @Test
    public void bubbleSort() {
        assertArrayEquals(EMPTY_ARRAY, Algorithms.bubbleSort(EMPTY_ARRAY.clone()));
        assertArrayEquals(ONE_ELEMENT_ARRAY, Algorithms.bubbleSort(ONE_ELEMENT_ARRAY.clone()));
        assertArrayEquals(ARRAY0_RESULT, Algorithms.bubbleSort(ARRAY0.clone()));
        assertArrayEquals(ARRAY1_RESULT, Algorithms.bubbleSort(ARRAY1.clone()));
        assertArrayEquals(ARRAY2_RESULT, Algorithms.bubbleSort(ARRAY2.clone()));
//        assertArrayEquals(ARRAY3_RESULT, Algorithms.bubbleSort(ARRAY3));
    }

    @Test
    public void quicksort() {
        assertArrayEquals(EMPTY_ARRAY, Algorithms.quicksort(EMPTY_ARRAY.clone()));
        assertArrayEquals(ONE_ELEMENT_ARRAY, Algorithms.quicksort(ONE_ELEMENT_ARRAY.clone()));
        assertArrayEquals(ARRAY0_RESULT, Algorithms.quicksort(ARRAY0.clone()));
        assertArrayEquals(ARRAY1_RESULT, Algorithms.quicksort(ARRAY1.clone()));
        assertArrayEquals(ARRAY2_RESULT, Algorithms.quicksort(ARRAY2.clone()));
        assertArrayEquals(ARRAY3_RESULT, Algorithms.quicksort(ARRAY3.clone()));
    }

    @Test
    public void mergeSort() {
        assertArrayEquals(EMPTY_ARRAY, Algorithms.mergeSort(EMPTY_ARRAY.clone()));
        assertArrayEquals(ONE_ELEMENT_ARRAY, Algorithms.mergeSort(ONE_ELEMENT_ARRAY.clone()));
        assertArrayEquals(ARRAY0_RESULT, Algorithms.mergeSort(ARRAY0.clone()));
        assertArrayEquals(ARRAY1_RESULT, Algorithms.mergeSort(ARRAY1.clone()));
        assertArrayEquals(ARRAY2_RESULT, Algorithms.mergeSort(ARRAY2.clone()));
        assertArrayEquals(ARRAY3_RESULT, Algorithms.mergeSort(ARRAY3.clone()));
    }

    @Test
    public void javaAPISort() {
        Long[] array = ARRAY3.clone();
        Arrays.sort(array);
        assertArrayEquals(ARRAY3_RESULT, array);
    }
}
